<Window x:Class="MyTemplate.Forms.UserEdit"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MyTemplate.Forms"
        xmlns:cnv="clr-namespace:MyTemplate.Class"
        mc:Ignorable="d"
        Loaded="Window_Loaded"
        Title="User Registration Information" Height="360" Width="480">

    <Window.Resources>
        <!--AuthorityConvertリソース定義-->
        <!--x:Key="AuthorityConver"でリソースとして登録、xaml内で参照できる-->
        <cnv:ReverseLookupMultiConverter x:Key="AuthorityConverter"/>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="42"/>
        </Grid.RowDefinitions>

        <DataGrid x:Name="dg_Users" Grid.Row="0" AutoGenerateColumns="False" IsReadOnly="True" Margin="5" SelectionMode="Single" SelectionUnit="FullRow">
            <DataGrid.Columns>
                <DataGridTemplateColumn Header="" Width="50">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button x:Name="bt_Delete" Content="削除" Command="{Binding DataContext.DeleteUserCommand, 
                                        RelativeSource={RelativeSource AncestorType=Window}}" CommandParameter="{Binding}" Click="bt_Delete_Click"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTextColumn Header="User Name" Binding="{Binding user_name}" Width="*"/>
                <DataGridTextColumn Header="User ID" Binding="{Binding user_id}" Width="*"/>

                <DataGridTextColumn Header="Authority">
                    <DataGridTextColumn.Binding>
                        <MultiBinding Converter="{StaticResource AuthorityConverter}">
                            <Binding Path="authority"/>
                            <Binding Path="DataContext.AuthorityDict" RelativeSource="{RelativeSource AncestorType=Window}"/>
                        </MultiBinding>
                    </DataGridTextColumn.Binding>
                </DataGridTextColumn>

            </DataGrid.Columns>
        </DataGrid>

        <Button x:Name="bt_Close" Grid.Row="1" Content="閉じる" Width="128" Height="32" HorizontalAlignment="Right" Margin="5" Click="bt_Close_Click"/>

    </Grid>
</Window>
